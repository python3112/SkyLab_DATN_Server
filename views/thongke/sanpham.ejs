<!DOCTYPE html>
<html>

<head>
  <title>
    <%= title %>
  </title>
  <link rel='stylesheet' href='/stylesheets/style_header.css' />
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <script src="https://kit.fontawesome.com/ae360af17e.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="/stylesheets/sidebar.css">
</head>

<body style="background-color: white;">
  <div class="wrapper">
    <%- include('../inc/sidebar') %>
      <div class="main">
        <%- include('../inc/header') %>

          <div class="content col-md-10 sm-10" style=" justify-content: space-around;">


            <div class="w-100">
              <div class="dropdown mb-1 w-100">
                <button class="btn btn-light w-100 text-start" type="button" id="dropdownMenuButton"
                  data-bs-toggle="dropdown" aria-expanded="false">
                  <%= year %>
                </button>
                <ul class="dropdown-menu m-2" aria-labelledby="dropdownMenuButton"
                  style="background-color: white; width: 100vw;">
                  <li><a class="dropdown-item" href="/thong-ke/thongke-sanpham/<%= 2024%>"
                      onclick="changeText('<%= 2024 %>')">2024</a></li>
                  <li><a class="dropdown-item" href="/Thong-ke/thongke-sanpham/<%= 2024 - 1 %>"
                      onclick="changeText('<%= 2024 - 1 %>')">
                      <%= 2024 - 1 %>
                    </a></li>
                  <li><a class="dropdown-item" href="/Thong-ke/thongke-sanpham/<%= 2024 - 2 %>"
                      onclick="changeText('<%= 2024 - 2 %>')">
                      <%= 2024 - 2 %>
                    </a></li>
                  <li><a class="dropdown-item" href="/Thong-ke/thongke-sanpham/<%= 2024 - 3 %>"
                      onclick="changeText('<%= 2024 - 3 %>')">
                      <%= 2024 - 3 %>
                    </a></li>
                  <li><a class="dropdown-item" href="/Thong-ke/thongke-sanpham/<%= 2024 - 4 %>"
                      onclick="changeText('<%= 2024 - 4 %>')">
                      <%= 2024 - 4 %>
                    </a></li>
                </ul>
              </div>
              <canvas class="w-100 " style="background-color: white;" id="myChart"></canvas>

            </div>

            <div class="mt-2">
              <% let totalRevenue=0; %>
                <% for (let i=0; i < dataSp.length; i++) { %>
                  <% totalRevenue +=dataSp[i]; %>
                    <% } %>
                    <button type="button" class="btn btn-danger" onclick="hideAllExcept()">Tổng Bán Được: <%= totalRevenue.toLocaleString() %></button>
                    <button type="button" class="btn btn-primary ms-4" onclick="showTop10BanChay()">top 10 bán chạy</button>
                    <button type="button" class="btn btn-success ms-4" onclick="showTop10YeuThich()">top 10 yêu thích</button>
            </div>
            <div  class="thongsoTheoThang">
              <% for (let i=0; i <=11; i++) { %>
                <% if(dataSp[i]==0){ %>
                  <% continue; %>
                    <% } %>
                      <a href="" class="btn btn-light w-100 mt-2 text-start">
                        Tháng <%= i+1 %>: <%= dataSp[i].toLocaleString() %> Sản Phẩm
                      </a>
                      <% } %>
            </div>
            <div class="top10banchay" style="display: none;">

            </div>
            <div class="top10yeuthich" style="display: none;">
              
            </div>



          </div>
          <%- include('../inc/footer') %>
      </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    function showTop10BanChay() {
        document.querySelector('.thongsoTheoThang').style.display = 'none';
        document.querySelector('.top10banchay').style.display = 'block';
        document.querySelector('.top10yeuthich').style.display = 'none';
    }

    function showTop10YeuThich() {
        document.querySelector('.thongsoTheoThang').style.display = 'none';
        document.querySelector('.top10banchay').style.display = 'none';
        document.querySelector('.top10yeuthich').style.display = 'block';
    }

    function hideAllExcept() {
        
        document.querySelector('.thongsoTheoThang').style.display = 'block';
        document.querySelector('.top10banchay').style.display = 'none';
        document.querySelector('.top10yeuthich').style.display = 'none';
    }
</script>
  <script>
    const ctx = document.getElementById('myChart');

    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6', "Tháng 7", "Tháng 8", "Tháng 9"
          , "Tháng 9", "Tháng 10", "Tháng 11", " Tháng 12"],
        datasets: [{
          label: 'Số Lượng Sản Phẩm Bán Được',
          data: <%= JSON.stringify(dataSp) %>,
          borderWidth: 0.5
        },

        ]
      },
      options: {
        animation: 3000,
        scales: {
          y: {
            beginAtZero: true,
          },


        }
      }
    });

    function changeText(selectedYear) {
      document.getElementById("dropdownMenuButton").textContent = selectedYear;
    }
  </script>
</body>

</html>